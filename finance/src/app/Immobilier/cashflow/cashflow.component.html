<div class="simulateur-container">
  <div class="header-section">
    <h1>Simulateur de Cashflow Immobilier</h1>
    <p class="subtitle">Calculez votre flux de trésorerie mensuel et évaluez la rentabilité de votre investissement</p>
  </div>

  <div class="content-grid">
    <div class="form-section">
      <p-panel header="Vos Revenus et Charges" styleClass="custom-panel">
        <div class="form-grid">
          <div class="form-group">
            <label>Loyer mensuel perçu</label>
            <p-inputNumber
              [(ngModel)]="values['Loyer']"
              (ngModelChange)="calculCashflow()"
              mode="currency"
              currency="EUR"
              locale="fr-FR"
              [min]="0">
            </p-inputNumber>
          </div>
          <div class="form-group">
            <label>Mensualité crédit</label>
            <p-inputNumber
              [(ngModel)]="values['Crédit']"
              (ngModelChange)="calculCashflow()"
              mode="currency"
              currency="EUR"
              locale="fr-FR"
              [min]="0">
            </p-inputNumber>
          </div>
          <div class="form-group">
            <label>Charges mensuelles</label>
            <p-inputNumber
              [(ngModel)]="values['Charges']"
              (ngModelChange)="calculCashflow()"
              mode="currency"
              currency="EUR"
              locale="fr-FR"
              [min]="0">
            </p-inputNumber>
          </div>
          <div class="form-group">
            <label>Impôts mensuels</label>
            <p-inputNumber
              [(ngModel)]="values['Impôts']"
              (ngModelChange)="calculCashflow()"
              mode="currency"
              currency="EUR"
              locale="fr-FR"
              [min]="0">
            </p-inputNumber>
          </div>
        </div>

        <div class="help-box" style="margin-top: 1rem;">
          <h4><i class="pi pi-info-circle"></i> Formule du cashflow</h4>
          <p style="margin: 0; font-size: 0.9rem;">
            <strong>Cashflow = Loyer - Crédit - Charges - Impôts</strong>
          </p>
        </div>
      </p-panel>
    </div>

    <div class="results-section">
      <p-panel header="Résultat" [styleClass]="cashflow >= 0 ? 'results-panel success' : 'results-panel'">
        <div class="main-result" [ngClass]="{'negative': cashflow < 0}">
          <div class="result-icon">
            <i class="pi" [ngClass]="{'pi-arrow-up': cashflow >= 0, 'pi-arrow-down': cashflow < 0}"></i>
          </div>
          <div class="result-content">
            <span class="result-value">{{ cashflow | number:'1.0-0' }} €</span>
            <span class="result-label">Cashflow mensuel</span>
          </div>
        </div>

        <div class="stats-grid" style="grid-template-columns: 1fr 1fr;">
          <div class="stat-card">
            <span class="stat-value">{{ cashflow * 12 | number:'1.0-0' }} €</span>
            <span class="stat-label">Cashflow annuel</span>
          </div>
          <div class="stat-card">
            <span class="stat-value" [ngClass]="{'highlight': cashflow < 0}">
              {{ cashflow >= 0 ? 'Positif' : 'Négatif' }}
            </span>
            <span class="stat-label">Statut</span>
          </div>
        </div>

        <div class="verdict" [ngClass]="{'positive': cashflow > 0, 'neutral': cashflow === 0, 'negative': cashflow < 0}" style="margin-top: 1rem;">
          <i class="pi" [ngClass]="{'pi-check-circle': cashflow > 0, 'pi-minus-circle': cashflow === 0, 'pi-times-circle': cashflow < 0}"></i>
          <div class="verdict-text">
            <strong *ngIf="cashflow > 0">Investissement autofinancé</strong>
            <strong *ngIf="cashflow === 0">Équilibre atteint</strong>
            <strong *ngIf="cashflow < 0">Effort d'épargne requis</strong>
            <p *ngIf="cashflow > 0">Votre investissement génère un surplus de {{ cashflow | number:'1.0-0' }} €/mois.</p>
            <p *ngIf="cashflow === 0">Les loyers couvrent exactement vos charges.</p>
            <p *ngIf="cashflow < 0">Vous devez compléter de {{ -cashflow | number:'1.0-0' }} €/mois.</p>
          </div>
        </div>
      </p-panel>

      <div style="margin-top: 1rem;">
        <p-panel header="Types de cashflow" styleClass="custom-panel">
          <div class="stats-grid" style="grid-template-columns: 1fr;">
            <div class="stat-card" style="background: #d4edda;">
              <span class="stat-value" style="color: #155724;">Positif</span>
              <span class="stat-label">Les revenus couvrent toutes les dépenses</span>
            </div>
            <div class="stat-card" style="background: #fff3cd;">
              <span class="stat-value" style="color: #856404;">Neutre</span>
              <span class="stat-label">Revenus et dépenses s'équilibrent</span>
            </div>
            <div class="stat-card" style="background: #f8d7da;">
              <span class="stat-value" style="color: #721c24;">Négatif</span>
              <span class="stat-label">Les dépenses dépassent les revenus</span>
            </div>
          </div>
        </p-panel>
      </div>
    </div>
  </div>

  <section class="content-section" style="margin-top: 2rem;">
    <p-panel header="Comprendre le cashflow immobilier" styleClass="custom-panel" [toggleable]="true" [collapsed]="true">
      <h3>Qu'est-ce que le cashflow ?</h3>
      <p>Le cashflow représente la différence entre les revenus générés par un investissement (loyers) et les dépenses associées (charges, remboursements de crédit, impôts). C'est un indicateur clé pour évaluer la rentabilité nette et la santé financière d'un investissement.</p>

      <h3>Calcul du cashflow</h3>
      <p><strong>Cashflow = Revenus nets – Dépenses</strong></p>
      <ul>
        <li><strong>Revenus nets :</strong> loyers perçus après déduction des impôts et charges récupérables.</li>
        <li><strong>Dépenses :</strong> remboursement du prêt, charges non récupérables, frais d'entretien, taxes foncières, assurance, etc.</li>
      </ul>

      <h3>Comment améliorer son cashflow ?</h3>
      <ul>
        <li>Optimiser les charges en négociant les contrats</li>
        <li>Rechercher des biens offrant un bon rapport loyer/prix</li>
        <li>Utiliser l'effet de levier du crédit</li>
        <li>Minimiser la fiscalité grâce aux dispositifs adaptés</li>
      </ul>

      <h3>Exemple pratique</h3>
      <p>Un investisseur perçoit 1 000 € de loyers mensuels. Ses dépenses (crédit, charges, impôts) s'élèvent à 800 € par mois. Son cashflow mensuel est donc : <strong>1 000 € - 800 € = 200 €</strong> positif.</p>
    </p-panel>
  </section>

  <section class="faq-section" style="margin-top: 2rem;">
    <h2>FAQ – Questions fréquentes sur le cashflow immobilier</h2>
    <dl>
      <dt>Qu'est-ce que le cashflow immobilier ?</dt>
      <dd>Le cashflow immobilier est la différence entre les revenus locatifs perçus et les charges liées au bien (crédit, taxes, entretien, etc.).</dd>

      <dt>Comment calculer le cashflow ?</dt>
      <dd>Il faut soustraire toutes les dépenses (mensualités, charges, taxes) des loyers perçus.</dd>

      <dt>Pourquoi le cashflow est-il important ?</dt>
      <dd>Il permet de vérifier si l'investissement génère un revenu positif ou négatif chaque mois.</dd>

      <dt>Le cashflow peut-il être négatif ?</dt>
      <dd>Oui, surtout au début d'un investissement, si les charges dépassent les loyers perçus.</dd>

      <dt>Comment améliorer son cashflow immobilier ?</dt>
      <dd>En optimisant le financement, en réduisant les charges ou en augmentant les loyers.</dd>
    </dl>
  </section>
</div>
